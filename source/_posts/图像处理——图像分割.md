---
title: 图像分割
body: [article, comments]
meta: 
  header: [title, author, date,category]
  footer: [updated, tags, share]
categories: 图像处理笔记
tags: 图像处理笔记
mathjax: true
---

> 我对图像分割的初级认识（现在的图像分割基本概况）

<!--more-->

## 一、图像分割分类

### 按着先进程度分

- #### 传统分割方法

①阈值分割

>阈值法的基本思想是基于图像的灰度特征来计算一个或多个灰度阈值，并将图像中每个像素的灰度值与阈值作比较，最后将像素根据比较结果分到合适的类别中。因此，该方法最为关键的一步就是按照某个准则函数来求解最佳灰度阈值。阈值法特别适用于目标和背景占据不同灰度级范围的图。

②基于区域的分割

> 基于区域的分割方法是以直接寻找区域为基础的分割技术，基于区域提取方法有两种基本形式：一种是区域生长，从单个像素出发，逐步合并以形成所需要的分割区域；另一种是从全局出发，逐步切割至所需的分割区域。

③基于边缘检测的分割

> 小波变换是近年来得到的广泛应用的数学工具，也是现在数字图像处理必学部分，它在时间域和频率域上都有量高的局部化性质，能将时域和频域统一于一体来研究信号。而且小波变换具有多尺度特性，能够在不同尺度上对信号进行分析，因此在图像分割方面的得到了应用，
> 而且小波变换具有检测二元函数的局部突变能力，因此可作为图像边缘检测工具。图像的边缘出现在图像局部灰度不连续处，对应于二进小波变换的模极大值点。通过检测小波变换模极大值点可以确定图像的边缘小波变换位于各个尺度上，而每个尺度上的小波变换都能提供一定的边缘信息，因此可进行多尺度边缘检测来得到比较理想的图像边缘。

- #### 深度学习分割

  ①VGGNet

  ②FCN(Fully Convolutional Networks )

  - DeepLab
  - DeconvNet
    - SegNet
  - PSPNet(Pyramid Scene Parsing Network)
  - Mask-RCNN



### 按分割目的划分

#### 普通分割

将不同分属不同物体的像素区域分开。 
如前景与后景分割开，狗的区域与猫的区域与背景分割开。

#### 语义分割

在普通分割的基础上，分类出每一块区域的语义（即这块区域是什么物体）。 
如把画面中的所有物体都指出它们各自的类别。

#### 实例分割

在语义分割的基础上，给每个物体编号。 
如这个是该画面中的狗A，那个是画面中的狗B。

## 二、基于深度学习分割

### <1>基于特征编码

在特征提取领域中VGGnet和ResNet是两个非常有统治力的方法，接下来的一些篇幅会对这两个方法进行简短的介绍

1. #### VGGNet

   由牛津大学计算机视觉组合和Google DeepMind公司研究员一起研发的深度卷积神经网络。它探索了卷积神经网络的深度和其性能之间的关系，通过反复的堆叠3×3的小型卷积核和2×2的最大池化层，成功的构建了16~19层深的卷积神经网络。VGGNet获得了ILSVRC 2014年比赛的亚军和定位项目的冠军，在top5上的错误率为7.5%。目前为止，VGGNet依然被用来提取图像的特征。
   ![img](https://imgconvert.csdnimg.cn/aHR0cHM6Ly9pLmxvbGkubmV0LzIwMTkvMDYvMDkvNWNmY2UxOGVjNjBlYjU1NDcxLnBuZw)
   ​ VGGNet的优缺点

   ①由于参数量主要集中在最后的三个FC（全连接层）当中，所以网络加深并不会带来参数爆炸的问题；

   ②多个小核卷积层的感受野等同于一个大核卷积层（三个3x3等同于一个7x7）但是参数量远少于大核卷积层而且非线性操作也多于后者，使得其学习能力较强

   ③VGG由于层数多而且最后的三个全连接层参数众多，导致其占用了更多的内存（140M）

2. #### ResNet

随着深度学习的应用，各种深度学习模型随之出现，虽然在每年都会出现性能更好的新模型，但是对于前人工作的提升却不是那么明显，其中有重要问题就是深度学习网络在堆叠到一定深度的时候会出现梯度消失的现象，导致误差升高效果变差，后向传播时无法将梯度反馈到前面的网络层，使得前方的网络层的参数难以更新，训练效果变差。这个时候ResNet恰好站出来，成为深度学习发展历程中一个重要的转折点。
​ ResNet是由微软研究院的Kaiming He等四名华人提出，他们通过自己提出的ResNet Unit成功训练出来152层的神经网络并在ILSVRC2015比赛中斩获冠军。ResNet语义分割领域最受欢迎且最广泛运用的神经网络.ResNet的核心思想就是在网络中引入恒等映射，允许原始输入信息直接传到后面的层中，在学习过程中可以只学习上一个网络输出的残差（F(x)），因此ResNet又叫做残差网络。、
![img](https://imgconvert.csdnimg.cn/aHR0cHM6Ly9pLmxvbGkubmV0LzIwMTkvMDYvMDkvNWNmY2UyMmEwNDhhNDI1ODE4LnBuZw)
使用到ResNet的分割模型：

- Efficient Neural Network（ENet）：该网络类似于ResNet的bottleNeck方法；
- ResNet-38：该网络在训练or测试阶段增加并移除了一些层，是一种浅层网络，它的结构是ResNet+FCN；
- full-resolution residual network(FRRN)：FRRN网络具有和ResNet相同优越的训练特性，它由残差流和池化流两个处理流组成；
- AdapNey：根据ResNet-50的网络进行改进，让原本的ResNet网络能够在更短的时间内学习到更多高分辨率的特征；
  ……
  ResNet的优缺点：
  1）引入了全新的网络结构（残差学习模块），形成了新的网络结构，可以使网络尽可能地加深；
  2）使得前馈/反馈传播算法能够顺利进行，结构更加简单；
  3）恒等映射地增加基本上不会降低网络的性能；
  4）建设性地解决了网络训练的越深，误差升高，梯度消失越明显的问题；
  5）由于ResNet搭建的层数众多，所以需要的训练时间也比平常网络要长。

### <2>基于区域选择

Regional proposal 在计算机视觉领域是一个非常常用的算法，尤其是在目标检测领域。其核心思想就是检测颜色空间和相似矩阵，根据这些来检测待检测的区域。然后根据检测结果可以进行分类预测。
在语义分割领域，基于区域选择的几个算法主要是由前人的有关于目标检测的工作渐渐延伸到语义分割的领域的。其大致经过了以下几个阶段：

#### ①R-CNN

是首个开创性地将深度神经网络应用到目标检测的算法，由于进行特征提取时是串行，处理耗时过长。

#### ②Fast R-CNN

节省了串行提取特征的时间.

#### ③Faster R-CNN

使用RPN替换了耗时的selective search算法，对整个网络结构有了突破性的优化；Faster R-CNN中使用的RPN和selective search比起来虽然速度更快，但是精度和selective search相比稍有不及，如果更注重速度而不是精度的话完全可以只使用RPN；

#### ④Mask R-CNN

是何恺明大神团队提出的一个基于Faster R-CNN模型的一种新型的分割模型，此论文斩获ICCV 2017的最佳论文，在Mask R-CNN的工作中，它主要完成了三件事情：目标检测，目标分类，像素级分割。

#### ⑤Mask Scoring R-CNN

恺明大神的Mask R-CNN已经很好啦！但是有个小毛病，就是评价函数只对目标检测的候选框进行打分，而不是分割模板（就是上文提到的优缺点中最后一点），所以会出现分割模板效果很差但是打分很高的情况。所以黄同学增加了对模板进行打分的MaskIoU Head，并且最终的分割结果在COCO数据集上超越了恺明大神，下面就是MS R-CNN的网络结构啦~

### <3>基于RNN的图像分割

#### ①ReSeg模型

#### ②MDRNNs模型（Multi-Dimensional Recurrent Neural Networks）

### <4>基于上采样/反卷积的分割方法

卷积神经网络在进行采样的时候会丢失部分细节信息，这样的目的是得到更具特征的价值。但是这个过程是不可逆的，有的时候会导致后面进行操作的时候图像的分辨率太低，出现细节丢失等问题。因此我们通过上采样在一定程度上可以补全一些丢失的信息，从而得到更加准确的分割边界。
接下来介绍几个非常著名的分割模型：

1. #### FCN

   在图像分割领域已然成为一个业界标杆，大多数的分割方法多多少少都会利用到FCN或者其中的一部分，比如前面我们讲过的Mask R-CNN。
   在FCN当中的反卷积-升采样结构中，图片会先进性上采样（扩大像素）；再进行卷积——通过学习获得权值。FCN的网络结构如下图所示：
   ![img](https://imgconvert.csdnimg.cn/aHR0cHM6Ly9pLmxvbGkubmV0LzIwMTkvMDYvMDkvNWNmYzc5MjIyZDc5YTk3MDY1LnBuZw)
   优缺点：

   - FCN对图像进行了像素级的分类，从而解决了语义级别的图像分割问题；
   - FCN可以接受任意尺寸的输入图像，可以保留下原始输入图像中的空间信息；
   - 得到的结果由于上采样的原因比较模糊和平滑，对图像中的细节不敏感；
   - 对各个像素分别进行分类，没有充分考虑像素与像素的关系，缺乏空间一致性。

2. #### SegNet

SegNet是剑桥提出的旨在解决自动驾驶或者智能机器人的图像语义分割深度网络，SegNet基于FCN，与FCN的思路十分相似，只是其编码-解码器和FCN的稍有不同，其解码器中使用去池化对特征图进行上采样，并保持高频细节的完整性；而编码器不使用全连接层，因此是拥有较少参数的轻量级网络。

SetNet的优缺点：

- 保存了高频部分的完整性；
- 网络不笨重，参数少，较为轻便；
- 对于分类的边界位置置信度较低；
- 对于难以分辨的类别，例如人与自行车，两者如果有相互重叠，不确定性会增加。
  以上两种网络结构就是基于反卷积/上采样的分割方法，当然其中最最最重要的就是FCN了，哪怕是后面大名鼎鼎的SegNet也是基于FCN架构的，而且FCN可谓是语义分割领域中开创级别的网络结构。

### <5>基于提高特征分辨率的分割方法

#### DeepLab

Google提出的DeepLab ,DeepLab有v1 v2 v3，第一篇名字叫做DeepLab: Semantic Image Segmentation with Deep Convolutional Nets, Atrous Convolution, and Fully Connected CRFs。这一系列论文引入了以下几点比较重要的方法：

第一个是带洞卷积，英文名叫做Dilated Convolution，或者Atrous Convolution。带洞卷积实际上就是普通的卷积核中间插入了几个洞，如下图。

![img](https://imgconvert.csdnimg.cn/aHR0cHM6Ly9pLmxvbGkubmV0LzIwMTkvMDYvMDkvNWNmYzdhNmNjNzZkMTYwNTI3LnBuZw)

它的运算量跟普通卷积保持一样，好处是它的“视野更大了”，比如普通3x3卷积的结果的视野是3x3，插入一个洞之后的视野是5x5。视野变大的作用是，在特征图缩小到同样倍数的情况下可以掌握更多图像的全局信息，这在语义分割中很重要。

![img](https://pic2.zhimg.com/v2-4959201e816888c6648f2e78cccfd253_b.jpg)

解决了DCNN的几个关于分辨率的问题：
1）内部数据结构丢失；空间曾计划信息丢失；
2）小物体信息无法重建；
当然空洞卷积也存在一定的问题，它的问题主要体现在以下两方面：
1）网格效应
加入我们仅仅多次叠加dilation rate 2的 3x3 的卷积核则会出现以下问题我们发现卷积核并不连续，也就是说并不是所有的像素都用来计算了，这样会丧失信息的连续性；
2）小物体信息处理不当
我们从空洞卷积的设计背景来看可以推测出它是设计来获取long-ranged information。然而空洞步频选取得大获取只有利于大物体得分割，而对于小物体的分割可能并没有好处。所以如何处理好不同大小物体之间的关系也是设计好空洞卷积网络的关键。

### <6>基于特征增强的分割方法

#### PSPNet(全局金字塔池化)

![](https://imgconvert.csdnimg.cn/aHR0cHM6Ly9pLmxvbGkubmV0LzIwMTkvMDYvMDkvNWNmYzdjMGE5NWQ4YTQyMTczLnBuZw)

类似于我们那节课讲的sift算子：为了捕捉多尺度特征，高层特征包含了更多的语义和更少的位置信息。结合多分辨率图像和多尺度特征描述符的优点，在不丢失分辨率的情况下提取图像中的全局和局部信息，这样就能在一定程度上提升网络的性能



以上均摘自下面两篇博客：

[WeisongZhao](https://blog.csdn.net/weixin_41923961/article/details/80946586)

[计算机视觉life](https://blog.csdn.net/electech6/article/details/95242875)

